# –ó–∞—â–∏—Ç–∞ –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è:

- üõ°Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞ –ø–æ IP –∞–¥—Ä–µ—Å—É
- üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- üö´ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö IP
- üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üîß –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-—Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:

```bash
mysql -u your_username -p your_database < bruteforce-schema.sql
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞—â–∏—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `middleware/bruteforce.js`:

```javascript
const BRUTEFORCE_CONFIG = {
  maxAttempts: 5,           // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
  windowMs: 15 * 60 * 1000, // –û–∫–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ (15 –º–∏–Ω—É—Ç)
  blockDuration: 30 * 60 * 1000, // –í—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (30 –º–∏–Ω—É—Ç)
  resetAttemptsAfter: 60 * 60 * 1000 // –°–±—Ä–æ—Å –ø–æ–ø—ã—Ç–æ–∫ —á–µ—Ä–µ–∑ —á–∞—Å
};
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞—â–∏—Ç–∞

1. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞**:
   - –ö–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
   - –í–µ–¥–µ—Ç—Å—è –ø–æ–¥—Å—á–µ—Ç –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –ø–æ IP –∞–¥—Ä–µ—Å—É
   - –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç—á–∏–∫–∞

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞**:
   - –ü–æ—Å–ª–µ 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ IP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 30 –º–∏–Ω—É—Ç
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
   - –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ –ø–æ–ø—ã—Ç–æ–∫

3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   - –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `login_attempts`
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è IP –∞–¥—Ä–µ—Å, –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Ä–µ–∑—É–ª—å—Ç–∞—Ç, User Agent
   - –õ–æ–≥–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è 30 –¥–Ω–µ–π —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–æ–π

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–î–æ—Å—Ç—É–ø –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É: `http://localhost:3000/admin/security`

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω—ã—Ö –∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤
- –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö –≤—Ö–æ–¥–æ–≤

#### –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞
- IP —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- IP —Å –≤—ã—Å–æ–∫–∏–º –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –Ω–µ—É–¥–∞—á (–±–æ–ª–µ–µ 80%)
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä—É—á–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

#### –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
- –ü—Ä–∏—á–∏–Ω–∞ –∏ –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

#### –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ø—ã—Ç–∫–∞—Ö –≤—Ö–æ–¥–∞
- –í—Ä–µ–º—è, IP, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- User Agent –±—Ä–∞—É–∑–µ—Ä–∞

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `login_attempts`
```sql
CREATE TABLE login_attempts (
  id INT AUTO_INCREMENT PRIMARY KEY,
  ip_address VARCHAR(45) NOT NULL,
  username VARCHAR(255),
  success TINYINT(1) NOT NULL DEFAULT 0,
  user_agent TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### –¢–∞–±–ª–∏—Ü–∞ `ip_blacklist`
```sql
CREATE TABLE ip_blacklist (
  id INT AUTO_INCREMENT PRIMARY KEY,
  ip_address VARCHAR(45) NOT NULL UNIQUE,
  reason VARCHAR(255),
  blocked_until TIMESTAMP NULL,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### –¢–∞–±–ª–∏—Ü–∞ `ip_whitelist`
```sql
CREATE TABLE ip_whitelist (
  id INT AUTO_INCREMENT PRIMARY KEY,
  ip_address VARCHAR(45) NOT NULL UNIQUE,
  description VARCHAR(255),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## API Endpoints

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- `GET /admin/security` - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `POST /admin/security/block-ip` - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∞–¥—Ä–µ—Å–∞
- `POST /admin/security/unblock-ip` - –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –∞–¥—Ä–µ—Å–∞

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

#### –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP
```javascript
fetch('/admin/security/block-ip', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ ip: '192.168.1.100' })
});
```

#### –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP
```javascript
fetch('/admin/security/unblock-ip', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ ip: '192.168.1.100' })
});
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

```javascript
const BRUTEFORCE_CONFIG = {
  maxAttempts: 5,           // 5 –ø–æ–ø—ã—Ç–æ–∫
  windowMs: 15 * 60 * 1000, // 15 –º–∏–Ω—É—Ç
  blockDuration: 30 * 60 * 1000, // 30 –º–∏–Ω—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  resetAttemptsAfter: 60 * 60 * 1000 // –°–±—Ä–æ—Å —á–µ—Ä–µ–∑ —á–∞—Å
};
```

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```javascript
const BRUTEFORCE_CONFIG = {
  maxAttempts: 3,           // –ú–µ–Ω—å—à–µ –ø–æ–ø—ã—Ç–æ–∫
  windowMs: 10 * 60 * 1000, // 10 –º–∏–Ω—É—Ç
  blockDuration: 60 * 60 * 1000, // 1 —á–∞—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  resetAttemptsAfter: 2 * 60 * 60 * 1000 // –°–±—Ä–æ—Å —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞
};
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

```javascript
// –ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
const sendSecurityAlert = (ip, attempts) => {
  // –û—Ç–ø—Ä–∞–≤–∫–∞ email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É
  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Slack/Discord
  // SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
};
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

- **Fail2ban**: –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
- **Cloudflare**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
- **WAF**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Web Application Firewall
- **SIEM**: –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–æ–≥–æ–≤ –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –†–µ–≥—É–ª—è—Ä–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö IP

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ webhook –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ SMS —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π

### 3. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
- –†–µ–≥—É–ª—è—Ä–Ω–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- –ò—â–∏—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∞—Ç–∞–∫
- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### 4. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ç–∞–±–ª–∏—Ü –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: IP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω, –Ω–æ –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∞–±–ª–∏—Ü—É `ip_blacklist`:
   ```sql
   SELECT * FROM ip_blacklist WHERE ip_address = 'YOUR_IP';
   ```

2. –†–∞–∑–±–ª–æ–∫–∏—Ä—É–π—Ç–µ IP —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∏–ª–∏ SQL:
   ```sql
   DELETE FROM ip_blacklist WHERE ip_address = 'YOUR_IP';
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

1. –î–æ–±–∞–≤—å—Ç–µ IP –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫:
   ```sql
   INSERT INTO ip_whitelist (ip_address, description) 
   VALUES ('YOUR_IP', '–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–π IP');
   ```

2. –£–≤–µ–ª–∏—á—å—Ç–µ –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã:
   ```sql
   SHOW TABLES LIKE '%blacklist%';
   SHOW TABLES LIKE '%login%';
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ middleware –ø–æ–¥–∫–ª—é—á–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

```javascript
const getIPLocation = async (ip) => {
  const response = await fetch(`https://ipapi.co/${ip}/json/`);
  return response.json();
};
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å reCAPTCHA

```javascript
const verifyRecaptcha = async (token) => {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ reCAPTCHA
  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google reCAPTCHA
};
```

### –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

```javascript
const require2FA = (req, res, next) => {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ 2FA
  // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TOTP/HOTP
};
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis**:
   ```javascript
   const redis = require('redis');
   const client = redis.createClient();
   ```

2. **–ò–Ω–¥–µ–∫—Å—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**:
   ```sql
   CREATE INDEX idx_ip_time ON login_attempts(ip_address, created_at);
   CREATE INDEX idx_success_time ON login_attempts(success, created_at);
   ```

3. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:
   ```javascript
   const cache = new Map();
   // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–æ–∫
   ```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã

1. **Rate Limiting**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
2. **IP Geolocation**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—é
3. **Behavioral Analysis**: –ê–Ω–∞–ª–∏–∑ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **Machine Learning**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –∞—Ç–∞–∫

### –ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –∞—É–¥–∏—Ç:
- –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞—â–∏—Ç—ã 